# Development Dockerfile
# Optimized for development with hot-reload and debugging

FROM apify/actor-python:3.13

WORKDIR /app

# Install development dependencies
COPY requirements.txt ./
RUN pip install --trusted-host pypi.org --trusted-host files.pythonhosted.org -r requirements.txt

# Install development tools
RUN pip install --trusted-host pypi.org --trusted-host files.pythonhosted.org pytest pytest-asyncio black isort mypy

# Copy source code
COPY src/ ./src/

# Create development directories
RUN mkdir -p /app/data/jobs /app/data/logs /app/storage

# Environment variables are provided by docker-compose.yml
# No need to copy .env file as variables are passed from host

# Set Python path to include app directory
ENV PYTHONPATH=/app

# Create non-root user for security
RUN useradd --create-home --shell /bin/bash app && \
    chown -R app:app /app

# Switch to non-root user
USER app

# Development entry point with hot-reload support
CMD ["python", "-m", "src.cli", "input.json"]

# Expose ports for development
EXPOSE 8000 6006

# Metadata
LABEL maintainer="LinkedIn Agent Team"
LABEL version="dev"
LABEL description="Development LinkedIn Agent with debugging support"